---
// PPO 剪切目标函数直观图
---

<div class="svg-container">
    <svg width="900" height="420" viewBox="0 0 900 420" xmlns="http://www.w3.org/2000/svg">
        <defs>
            <linearGradient id="ppoClipBand" x1="0%" y1="0%" x2="100%" y2="0%">
                <stop offset="0%" style="stop-color:#f97316;stop-opacity:0.18" />
                <stop offset="100%" style="stop-color:#f97316;stop-opacity:0.08" />
            </linearGradient>
            <filter id="ppoClipShadow">
                <feGaussianBlur in="SourceAlpha" stdDeviation="3"/>
                <feOffset dx="0" dy="2" result="offsetblur"/>
                <feComponentTransfer>
                    <feFuncA type="linear" slope="0.2"/>
                </feComponentTransfer>
                <feMerge>
                    <feMergeNode/>
                    <feMergeNode in="SourceGraphic"/>
                </feMerge>
            </filter>
        </defs>

        <text x="450" y="32" text-anchor="middle" font-size="22" font-weight="bold" fill="#1e293b">PPO 剪切目标：限制更新幅度</text>
        <text x="450" y="56" text-anchor="middle" font-size="14" fill="#64748b">横轴是比率 r_t，纵轴是 surrogate 目标值</text>

        <!-- 坐标轴 -->
        <line x1="120" y1="320" x2="820" y2="320" stroke="#1f2937" stroke-width="2"/>
        <line x1="120" y1="320" x2="120" y2="110" stroke="#1f2937" stroke-width="2"/>

        <text x="830" y="324" font-size="12" fill="#334155">
            r<tspan baseline-shift="sub" font-size="9">t</tspan>
        </text>
        <text x="100" y="110" font-size="12" fill="#334155" text-anchor="end">L(θ)</text>

        <!-- 剪切区间 -->
        <rect x="360" y="120" width="200" height="200" fill="url(#ppoClipBand)" stroke="#f97316" stroke-width="1.5" rx="10"/>
        <text x="460" y="140" text-anchor="middle" font-size="12" fill="#f97316">clip 区间</text>
        <text x="460" y="156" text-anchor="middle" font-size="11" fill="#f97316">[1-ε, 1+ε]</text>

        <!-- 线性 surrogate -->
        <line x1="140" y1="290" x2="800" y2="140" stroke="#2563eb" stroke-width="3"/>
        <text x="740" y="150" font-size="12" fill="#2563eb">
            r<tspan baseline-shift="sub" font-size="9">t</tspan> · Â<tspan baseline-shift="sub" font-size="9">t</tspan>
        </text>

        <!-- clipped surrogate -->
        <path d="M 140 290 L 360 240 L 360 240 L 560 240 L 560 200 L 800 140" stroke="#0f766e" stroke-width="3" fill="none" filter="url(#ppoClipShadow)"/>
        <text x="620" y="230" font-size="12" fill="#0f766e">
            clip(r<tspan baseline-shift="sub" font-size="9">t</tspan>) · Â<tspan baseline-shift="sub" font-size="9">t</tspan>
        </text>

        <!-- 标注关键点 -->
        <line x1="360" y1="320" x2="360" y2="120" stroke="#f97316" stroke-width="1.5" stroke-dasharray="6,6"/>
        <line x1="560" y1="320" x2="560" y2="120" stroke="#f97316" stroke-width="1.5" stroke-dasharray="6,6"/>
        <text x="360" y="338" font-size="12" fill="#f97316" text-anchor="middle">1-ε</text>
        <text x="560" y="338" font-size="12" fill="#f97316" text-anchor="middle">1+ε</text>

        <text x="210" y="350" font-size="12" fill="#64748b">更新过小：基本线性</text>
        <text x="650" y="350" font-size="12" fill="#64748b">更新过大：收益被截断</text>
    </svg>
</div>
